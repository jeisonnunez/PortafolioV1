;002C INT 5.5
;0034 INT 6.5
;003C INT 7.5
;0024 INT TRAP

;SE DEBE TOMAR EN CUENTA CUAL ES LA PRIORIDAD MAYOR PARA VERIFICAR SI LAS INTERRUPCIONES FUNCIONAN EN ARMONIA

;CAMBIAR LOS REGISTROS AHORA PARA EL .ORG 0100H

;HABILITAR O DESHABILITAR INSTRUCCIONES
;EI(ENABLE INTERRUPTION): HABILITAR INTERRUPCION
;DI(ENABLE INTERRUPTION): DESHABILITAR INTERRUPCION
.data 1000h
COD7S: DB 77H, 44H, 3EH, 6EH, 4DH, 6BH, 7BH, 46H, 7FH, 4FH
.ORG 0100h
REPETIR:

	INR A
	EI
	OUT 00H
	JMP REPETIR
HLT
SIETESEGMENTOS:PUSH H; CODIGO DE 7 SEGMENTOS
	PUSH PSW
	PUSH D
	LXI H,COD7S
	MOV A,D
	ADD L
	MOV L,A
	MOV D,M
	CALL OUTPORT
	POP D
	POP PSW
	POP H
RET

OUTPORT: PUSH PSW
	MOV A,B
	CPI 00H
	JNZ P1
	MOV A,D
	OUT 00H
	JMP RS	
P1:	CPI 01H
	JNZ P2
	MOV A,D
	OUT 01H
	JMP RS
P2:	CPI 02H
	JNZ P3
	MOV A,D
	OUT 02H
	JMP RS
P3:	CPI 03H
	JNZ P4
	MOV A,D
	OUT 03H
	JMP RS
P4:	CPI 04H
	JNZ P5
	MOV A,D
	OUT 04H
	JMP RS
P5:	CPI 05H
	JNZ P6
	MOV A,D
	OUT 05H
	JMP RS
P6:	CPI 06H
	JNZ P7
	MOV A,D
	OUT 06H
	JMP RS
P7:	CPI 07H
	JNZ RS
	MOV A,D
	OUT 07H
RS:	POP PSW

TECLADO:;RUTINA DE TECLADO QUE LEE EL PUERTO 00H RESTRLE 30 Y HACE UN OUT AL PUERTO 01H
	PUSH PSW
	IN 00H
	SUI 30H
	OUT 01H
	POP PSW
RET

TIEMPO:;INCREMENTAR EL DATO DE ENTRADA QUE ES D 
	INR D	
	MVI B,04H
	CALL SIETESEGMENTOS
	MOV A,D
	CPI 0AH
	JNZ RETORNOTIEMPO
	MVI D,00H
	
RETORNOTIEMPO:RET


.ORG 002CH ;RUTINA DE INTERRUPCION 5.5
	CALL TECLADO
RET
.ORG 0034H ;RUTINA DE INTERRUPCION 6.5
	CALL TIEMPO
RET
.ORG 003CH ;RUTINA DE INTERRUPCION 7.5

RET
.ORG 0024H ;RUTINA DE INTERRUPCION TRAP

RET
